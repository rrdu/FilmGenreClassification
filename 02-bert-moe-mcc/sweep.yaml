# sweep.yaml
# Uses Bayesian optimization by default (change to "random" or "grid" if desired)
method: bayes
metric:
  name: val_acc
  goal: maximize

# The program to run (your uploaded training script)
program: ./train.py

# How many runs to perform in total (agent stops when this is reached)
early_terminate:
  type: hyperband
  min_iter: 5

parameters:
  seed:
    distribution: q_uniform
    min: 1
    max: 5
    q: 1
  learning_rate:
    distribution: log_uniform_values
    min: 1e-5
    max: 5e-3
  batch_size:
    distribution: categorical
    values: [32, 64, 128]
  num_experts:
    distribution: categorical
    values: [4, 8, 16]
  top_k:
    distribution: categorical
    values: [1, 2]
  aux_loss_weight:
    distribution: log_uniform_values
    min: 1e-4
    max: 1.0
  expert_hidden_dim:
    distribution: categorical
    values: [64, 128, 256]
  encoder_emb_dim:
    distribution: categorical
    values: [128, 256]
  warmup_frac:
    distribution: uniform
    min: 0.01
    max: 0.2
  max_epochs:
    value: 10
